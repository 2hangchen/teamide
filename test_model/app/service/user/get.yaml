api: # 暴露服务接口
  request:
    path: /user/get # 提供WEB 接口能力
    method: GET

inVariables: # 定义入参变量
  - userId:
      value: userId
      dataType: long # 参数 userId
      required: true
      dataPlace: param # 通过request body传参

outVariable: # 定义出参变量
  name: user
  dataType: userInfo # 类型为 结构体 userInfo 类型

steps:
  - redisGet: # 插入用户密码信息
      key: "'user:info:' + userId"
    variableName: user # 定义变量名 接收 Redis 返回的值 后续使用
    variableDataType: userInfo # 类型为 结构体 userInfo 类型

  - if: user == null
    sqlSelect:
      selectOne: true #是统计查询
      table: TM_USER_INFO
      wheres:
        - userId = {userId}
    variableName: user
    variableDataType: userInfo

    steps: # 子流程步骤
      - if: user != null # 如果库中存在用户 则缓存用户
        redisSet: # 缓存用户信息到Redis
          key: "'user:info:' + userId"
          value: user
